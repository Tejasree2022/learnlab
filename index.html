<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LearnLab - Clear Explanations & Real Practice</title>
    <style>
        /* Clean, focused styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f8f9fa;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        /* Header */
        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px 0;
        }
        
        h1 {
            color: #1a73e8;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .subtitle {
            color: #5f6368;
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }
        
        /* Search */
        .search-box {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        input[type="text"] {
            width: 100%;
            padding: 16px 20px;
            font-size: 1.1rem;
            border: 2px solid #ddd;
            border-radius: 8px;
            margin-bottom: 15px;
            transition: border-color 0.3s;
        }
        
        input[type="text"]:focus {
            outline: none;
            border-color: #1a73e8;
        }
        
        button {
            width: 100%;
            padding: 16px;
            background: #1a73e8;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        button:hover {
            background: #0d62d9;
        }
        
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        .examples {
            margin-top: 20px;
            color: #5f6368;
            font-size: 0.95rem;
        }
        
        .example-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .example-tag {
            background: #e8f0fe;
            color: #1a73e8;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        /* Loading */
        .loading {
            text-align: center;
            padding: 40px;
            display: none;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #e8f0fe;
            border-top: 4px solid #1a73e8;
            border-radius: 50%;
            margin: 0 auto 20px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Error */
        .error {
            background: #fce8e6;
            color: #c5221f;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
            border-left: 4px solid #c5221f;
        }
        
        /* Learning Guide */
        .guide {
            background: white;
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .guide-header {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f1f3f4;
        }
        
        .guide-title {
            color: #1a73e8;
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        /* Explanation */
        .explanation {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 40px;
            line-height: 1.8;
        }
        
        .explanation h3 {
            color: #1a73e8;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .explanation p {
            margin-bottom: 15px;
        }
        
        .explanation p:last-child {
            margin-bottom: 0;
        }
        
        /* Tasks */
        .tasks h3 {
            color: #1a73e8;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .task-list {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        .task {
            border: 1px solid #e8f0fe;
            border-radius: 8px;
            padding: 25px;
            position: relative;
            transition: transform 0.3s;
        }
        
        .task:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        }
        
        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .task-number {
            color: #5f6368;
            font-weight: 600;
        }
        
        .difficulty {
            font-size: 0.8rem;
            font-weight: 700;
            padding: 4px 12px;
            border-radius: 20px;
        }
        
        .beginner { background: #e6f4ea; color: #137333; }
        .intermediate { background: #fef7e0; color: #b06000; }
        .advanced { background: #fce8e6; color: #c5221f; }
        
        .task-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: #202124;
        }
        
        .task-description {
            color: #5f6368;
            margin-bottom: 20px;
            line-height: 1.7;
        }
        
        .hint {
            background: #f0f6ff;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #1a73e8;
            font-size: 0.95rem;
            color: #5f6368;
        }
        
        .hint strong {
            color: #1a73e8;
        }
        
        /* Tips */
        .tips {
            background: #e8f0fe;
            padding: 20px;
            border-radius: 8px;
            margin-top: 40px;
        }
        
        .tips h3 {
            color: #1a73e8;
            margin-bottom: 10px;
        }
        
        .tips ul {
            padding-left: 20px;
            color: #5f6368;
        }
        
        .tips li {
            margin-bottom: 8px;
        }
        
        /* Footer */
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #5f6368;
            font-size: 0.9rem;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 0 10px;
            }
            
            .search-box, .guide {
                padding: 20px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .guide-title {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <h1>LearnLab</h1>
            <p class="subtitle">Clear explanations & real practice tasks. Understand anything properly.</p>
        </header>
        
        <!-- Search Box -->
        <div class="search-box">
            <input type="text" id="topicInput" placeholder="What do you want to understand clearly?">
            <button id="learnBtn" onclick="learnTopic()">Get Clear Explanation â†’</button>
            
            <div class="examples">
                <p>Try: </p>
                <div class="example-tags">
                    <div class="example-tag" onclick="searchExample('python functions')">Python Functions</div>
                    <div class="example-tag" onclick="searchExample('photosynthesis')">Photosynthesis</div>
                    <div class="example-tag" onclick="searchExample('machine learning basics')">Machine Learning</div>
                    <div class="example-tag" onclick="searchExample('how computers work')">How Computers Work</div>
                    <div class="example-tag" onclick="searchExample('supply and demand')">Supply & Demand</div>
                </div>
            </div>
        </div>
        
        <!-- Loading -->
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Creating clear learning guide...</p>
        </div>
        
        <!-- Error -->
        <div class="error" id="error"></div>
        
        <!-- Learning Guide -->
        <div class="guide" id="guide">
            <!-- Content will be loaded here -->
        </div>
        
        <!-- Welcome Message -->
        <div class="guide" id="welcomeGuide">
            <div class="guide-header">
                <h2 class="guide-title">Welcome to LearnLab</h2>
            </div>
            
            <div class="explanation">
                <h3>ðŸŽ¯ How to Learn Effectively</h3>
                <p><strong>LearnLab helps you truly understand topics</strong>, not just memorize facts.</p>
                
                <p><strong>1. Clear Explanations:</strong> We break complex topics into simple, understandable parts with real examples.</p>
                
                <p><strong>2. Practical Tasks:</strong> Practice with real-world problems that build your understanding step by step.</p>
                
                <p><strong>3. Helpful Hints:</strong> Get guidance when you're stuck, not just answers.</p>
            </div>
            
            <div class="tasks">
                <h3>ðŸ“š Example Learning Topics</h3>
                <div class="task-list">
                    <div class="task">
                        <div class="task-header">
                            <span class="task-number">Programming</span>
                            <span class="difficulty beginner">Beginner</span>
                        </div>
                        <div class="task-title">Python Functions Explained Clearly</div>
                        <div class="task-description">Learn what functions are, why they matter, and how to use them with practical examples.</div>
                    </div>
                    
                    <div class="task">
                        <div class="task-header">
                            <span class="task-number">Science</span>
                            <span class="difficulty intermediate">Intermediate</span>
                        </div>
                        <div class="task-title">Photosynthesis Made Simple</div>
                        <div class="task-description">Understand how plants make food, with clear analogies and real-world importance.</div>
                    </div>
                    
                    <div class="task">
                        <div class="task-header">
                            <span class="task-number">Technology</span>
                            <span class="difficulty advanced">Advanced</span>
                        </div>
                        <div class="task-title">Machine Learning Fundamentals</div>
                        <div class="task-description">Learn core ML concepts with practical implementation tasks.</div>
                    </div>
                </div>
            </div>
            
            <div class="tips">
                <h3>ðŸ’¡ Getting Started</h3>
                <ul>
                    <li>Type any topic you want to understand</li>
                    <li>Read the explanation carefully</li>
                    <li>Start with beginner tasks</li>
                    <li>Use hints when you need help</li>
                    <li>Practice regularly for best results</li>
                </ul>
            </div>
        </div>
        
        <!-- Footer -->
        <footer>
            <p>LearnLab â€¢ Clear Learning â€¢ Real Practice â€¢ Powered by Google Gemini AI</p>
        </footer>
    </div>

    <script>
        // DOM Elements
        const topicInput = document.getElementById('topicInput');
        const learnBtn = document.getElementById('learnBtn');
        const loading = document.getElementById('loading');
        const error = document.getElementById('error');
        const guide = document.getElementById('guide');
        const welcomeGuide = document.getElementById('welcomeGuide');
        
        // Examples for placeholder
        const examples = [
            "python functions with examples",
            "photosynthesis step by step", 
            "how machine learning works",
            "supply and demand explained",
            "what is blockchain technology",
            "basics of web development",
            "how to learn programming",
            "quantum computing for beginners"
        ];
        
        // Set random placeholder
        function setRandomPlaceholder() {
            const randomExample = examples[Math.floor(Math.random() * examples.length)];
            topicInput.placeholder = `e.g., "${randomExample}"`;
        }
        
        // Learn a topic
        async function learnTopic() {
            const topic = topicInput.value.trim();
            
            if (!topic || topic.length < 2) {
                showError('Please enter a topic you want to understand');
                topicInput.focus();
                return;
            }
            
            // Show loading, hide others
            loading.style.display = 'block';
            error.style.display = 'none';
            guide.style.display = 'none';
            welcomeGuide.style.display = 'none';
            
            // Disable button
            learnBtn.disabled = true;
            learnBtn.textContent = 'Creating learning guide...';
            
            try {
                console.log(`Learning: "${topic}"`);
                
                // Call API
                const response = await fetch(`http://localhost:3000/api/learn?topic=${encodeURIComponent(topic)}`);
                const data = await response.json();
                
                if (!response.ok) {
                    if (response.status === 429) {
                        throw new Error('Learning limit reached. Free tier: 60 requests/minute. Wait a moment.');
                    }
                    throw new Error(data.error || 'Failed to create learning guide');
                }
                
                // Display learning guide
                displayLearningGuide(data);
                error.style.display = 'none';
                
            } catch (err) {
                console.error('Error:', err);
                showError(err.message);
            } finally {
                loading.style.display = 'none';
                learnBtn.disabled = false;
                learnBtn.textContent = 'Get Clear Explanation â†’';
            }
        }
        
        // Display learning guide
        function displayLearningGuide(data) {
            const guideData = data.guide || data.fallback;
            
            guide.innerHTML = `
                <div class="guide-header">
                    <h2 class="guide-title">${guideData.title}</h2>
                </div>
                
                <div class="explanation">
                    <h3>ðŸ“– Clear Explanation</h3>
                    ${formatExplanation(guideData.explanation)}
                </div>
                
                <div class="tasks">
                    <h3>âœ… Practice Tasks</h3>
                    <div class="task-list">
                        ${guideData.tasks.map((task, index) => `
                            <div class="task">
                                <div class="task-header">
                                    <span class="task-number">Task ${index + 1}</span>
                                    <span class="difficulty ${task.difficulty}">${task.difficulty}</span>
                                </div>
                                <div class="task-title">${task.title}</div>
                                <div class="task-description">${task.description}</div>
                                ${task.hint ? `
                                    <div class="hint">
                                        <strong>ðŸ’¡ Hint:</strong> ${task.hint}
                                    </div>
                                ` : ''}
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                ${data.tips ? `
                    <div class="tips">
                        <h3>ðŸ’¡ Learning Tips</h3>
                        <ul>
                            ${data.tips.map(tip => `<li>${tip}</li>`).join('')}
                        </ul>
                    </div>
                ` : ''}
            `;
            
            guide.style.display = 'block';
            welcomeGuide.style.display = 'none';
            
            // Scroll to guide
            guide.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
        
        // Format explanation text
        function formatExplanation(text) {
            if (!text) return '<p>Explanation not available.</p>';
            
            // Split by paragraphs
            const paragraphs = text.split('\n\n');
            
            if (paragraphs.length <= 1) {
                // Simple newline handling
                return text.split('\n').filter(line => line.trim()).map(line => 
                    `<p>${line}</p>`
                ).join('');
            }
            
            // Proper paragraph handling
            return paragraphs.map(para => 
                para.trim() ? `<p>${para}</p>` : ''
            ).join('');
        }
        
        // Show error
        function showError(message) {
            error.innerHTML = message;
            error.style.display = 'block';
            guide.style.display = 'none';
            
            // Scroll to error
            error.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
        
        // Search example
        function searchExample(topic) {
            topicInput.value = topic;
            learnTopic();
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Set placeholder
            setRandomPlaceholder();
            setInterval(setRandomPlaceholder, 10000);
            
            // Enter key support
            topicInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    learnTopic();
                }
            });
            
            // Focus input
            topicInput.focus();
            
            // Show welcome guide initially
            welcomeGuide.style.display = 'block';
            guide.style.display = 'none';
        });
    </script>
</body>
</html>
